<!DOCTYPE html>
<html lang="en">
  <head>
    <title>Error-Handling  Reference</title>
    <link rel="stylesheet" type="text/css" href="css/jazzy.css" />
    <link rel="stylesheet" type="text/css" href="css/highlight.css" />
    <meta charset='utf-8'>
    <script src="js/jquery.min.js" defer></script>
    <script src="js/jazzy.js" defer></script>
    
  </head>
  <body>
    <a title="Error-Handling  Reference"></a>
    <header>
      <div class="content-wrapper">
        <p><a href="index.html">MongoSwift Docs</a> (100% documented)</p>
        <p class="header-right"><a href="https://github.com/mongodb/mongo-swift-driver"><img src="img/gh.png"/>View on GitHub</a></p>
        <p class="header-right"><a href="dash-feed://https%3A%2F%2Fmongodb%2Egithub%2Eio%2Fdocsets%2FMongoSwift%2Exml"><img src="img/dash.png"/>Install in Dash</a></p>
      </div>
    </header>
    <div class="content-wrapper">
      <p id="breadcrumbs">
        <a href="index.html">MongoSwift Reference</a>
        <img id="carat" src="img/carat.png" />
        Error-Handling  Reference
      </p>
    </div>
    <div class="content-wrapper">
      <nav class="sidebar">
        <ul class="nav-groups">
          <li class="nav-group-name">
            <a href="Guides.html">Guides</a>
            <ul class="nav-group-tasks">
              <li class="nav-group-task">
                <a href="development.html">Development</a>
              </li>
              <li class="nav-group-task">
                <a href="error-handling.html">Error-Handling</a>
              </li>
            </ul>
          </li>
          <li class="nav-group-name">
            <a href="Classes.html">Classes</a>
            <ul class="nav-group-tasks">
              <li class="nav-group-task">
                <a href="Classes/BSONDecoder.html">BSONDecoder</a>
              </li>
              <li class="nav-group-task">
                <a href="Classes/BSONDecoder/DateDecodingStrategy.html">– DateDecodingStrategy</a>
              </li>
              <li class="nav-group-task">
                <a href="Classes/BSONDecoder/UUIDDecodingStrategy.html">– UUIDDecodingStrategy</a>
              </li>
              <li class="nav-group-task">
                <a href="Classes/BSONDecoder/DataDecodingStrategy.html">– DataDecodingStrategy</a>
              </li>
              <li class="nav-group-task">
                <a href="Classes/BSONEncoder.html">BSONEncoder</a>
              </li>
              <li class="nav-group-task">
                <a href="Classes/BSONEncoder/DateEncodingStrategy.html">– DateEncodingStrategy</a>
              </li>
              <li class="nav-group-task">
                <a href="Classes/BSONEncoder/UUIDEncodingStrategy.html">– UUIDEncodingStrategy</a>
              </li>
              <li class="nav-group-task">
                <a href="Classes/BSONEncoder/DataEncodingStrategy.html">– DataEncodingStrategy</a>
              </li>
              <li class="nav-group-task">
                <a href="Classes.html#/s:10MongoSwift18BulkWriteOperationC">BulkWriteOperation</a>
              </li>
              <li class="nav-group-task">
                <a href="Classes/ClientSession.html">ClientSession</a>
              </li>
              <li class="nav-group-task">
                <a href="Classes/DocumentIterator.html">DocumentIterator</a>
              </li>
              <li class="nav-group-task">
                <a href="Classes.html#/s:10MongoSwift15DocumentStorageC">DocumentStorage</a>
              </li>
              <li class="nav-group-task">
                <a href="Classes/MongoClient.html">MongoClient</a>
              </li>
              <li class="nav-group-task">
                <a href="Classes/MongoCollection.html">MongoCollection</a>
              </li>
              <li class="nav-group-task">
                <a href="Classes/MongoCollection/DeleteOneModel.html">– DeleteOneModel</a>
              </li>
              <li class="nav-group-task">
                <a href="Classes/MongoCollection/DeleteManyModel.html">– DeleteManyModel</a>
              </li>
              <li class="nav-group-task">
                <a href="Classes/MongoCollection/InsertOneModel.html">– InsertOneModel</a>
              </li>
              <li class="nav-group-task">
                <a href="Classes/MongoCollection/ReplaceOneModel.html">– ReplaceOneModel</a>
              </li>
              <li class="nav-group-task">
                <a href="Classes/MongoCollection/UpdateOneModel.html">– UpdateOneModel</a>
              </li>
              <li class="nav-group-task">
                <a href="Classes/MongoCollection/UpdateManyModel.html">– UpdateManyModel</a>
              </li>
              <li class="nav-group-task">
                <a href="Classes/MongoCursor.html">MongoCursor</a>
              </li>
              <li class="nav-group-task">
                <a href="Classes/MongoDatabase.html">MongoDatabase</a>
              </li>
              <li class="nav-group-task">
                <a href="Classes/ReadConcern.html">ReadConcern</a>
              </li>
              <li class="nav-group-task">
                <a href="Classes/ReadConcern/Level.html">– Level</a>
              </li>
              <li class="nav-group-task">
                <a href="Classes/ReadPreference.html">ReadPreference</a>
              </li>
              <li class="nav-group-task">
                <a href="Classes/ReadPreference/Mode.html">– Mode</a>
              </li>
              <li class="nav-group-task">
                <a href="Classes/WriteConcern.html">WriteConcern</a>
              </li>
              <li class="nav-group-task">
                <a href="Classes/WriteConcern/W.html">– W</a>
              </li>
            </ul>
          </li>
          <li class="nav-group-name">
            <a href="Enums.html">Enumerations</a>
            <ul class="nav-group-tasks">
              <li class="nav-group-task">
                <a href="Enums/BSONType.html">BSONType</a>
              </li>
              <li class="nav-group-task">
                <a href="Enums/CursorType.html">CursorType</a>
              </li>
              <li class="nav-group-task">
                <a href="Enums/DataCodingStrategy.html">DataCodingStrategy</a>
              </li>
              <li class="nav-group-task">
                <a href="Enums/DateCodingStrategy.html">DateCodingStrategy</a>
              </li>
              <li class="nav-group-task">
                <a href="Enums/Hint.html">Hint</a>
              </li>
              <li class="nav-group-task">
                <a href="Enums/MongoEventType.html">MongoEventType</a>
              </li>
              <li class="nav-group-task">
                <a href="Enums/ReturnDocument.html">ReturnDocument</a>
              </li>
              <li class="nav-group-task">
                <a href="Enums/RuntimeError.html">RuntimeError</a>
              </li>
              <li class="nav-group-task">
                <a href="Enums/ServerError.html">ServerError</a>
              </li>
              <li class="nav-group-task">
                <a href="Enums/UUIDCodingStrategy.html">UUIDCodingStrategy</a>
              </li>
              <li class="nav-group-task">
                <a href="Enums/UserError.html">UserError</a>
              </li>
            </ul>
          </li>
          <li class="nav-group-name">
            <a href="Extensions.html">Extensions</a>
            <ul class="nav-group-tasks">
              <li class="nav-group-task">
                <a href="Extensions/Array.html">Array</a>
              </li>
              <li class="nav-group-task">
                <a href="Extensions/Bool.html">Bool</a>
              </li>
              <li class="nav-group-task">
                <a href="Extensions/Date.html">Date</a>
              </li>
              <li class="nav-group-task">
                <a href="Extensions/Double.html">Double</a>
              </li>
              <li class="nav-group-task">
                <a href="Extensions/Int.html">Int</a>
              </li>
              <li class="nav-group-task">
                <a href="Extensions/Int32.html">Int32</a>
              </li>
              <li class="nav-group-task">
                <a href="Extensions/Int64.html">Int64</a>
              </li>
              <li class="nav-group-task">
                <a href="Extensions/NSRegularExpression.html">NSRegularExpression</a>
              </li>
              <li class="nav-group-task">
                <a href="Extensions/Notification.html">Notification</a>
              </li>
              <li class="nav-group-task">
                <a href="Extensions/Notification/Name.html">– Name</a>
              </li>
              <li class="nav-group-task">
                <a href="Extensions/String.html">String</a>
              </li>
              <li class="nav-group-task">
                <a href="Extensions/UUID.html">UUID</a>
              </li>
            </ul>
          </li>
          <li class="nav-group-name">
            <a href="Functions.html">Functions</a>
            <ul class="nav-group-tasks">
              <li class="nav-group-task">
                <a href="Functions.html#/s:10MongoSwift10bsonEqualsySbAA9BSONValue_pSg_ADtF">bsonEquals(_:_:)</a>
              </li>
              <li class="nav-group-task">
                <a href="Functions.html#/s:10MongoSwift10bsonEqualsySbAA9BSONValue_p_AaC_ptF">bsonEquals(_:_:)</a>
              </li>
              <li class="nav-group-task">
                <a href="Functions.html#/s:10MongoSwift07cleanupaB0yyF">cleanupMongoSwift()</a>
              </li>
            </ul>
          </li>
          <li class="nav-group-name">
            <a href="Protocols.html">Protocols</a>
            <ul class="nav-group-tasks">
              <li class="nav-group-task">
                <a href="Protocols/BSONNumber.html">BSONNumber</a>
              </li>
              <li class="nav-group-task">
                <a href="Protocols/BSONValue.html">BSONValue</a>
              </li>
              <li class="nav-group-task">
                <a href="Protocols/CodingStrategyProvider.html">CodingStrategyProvider</a>
              </li>
              <li class="nav-group-task">
                <a href="Protocols.html#/s:10MongoSwift0A5ErrorP">MongoError</a>
              </li>
              <li class="nav-group-task">
                <a href="Protocols/MongoEvent.html">MongoEvent</a>
              </li>
              <li class="nav-group-task">
                <a href="Protocols/WriteModel.html">WriteModel</a>
              </li>
            </ul>
          </li>
          <li class="nav-group-name">
            <a href="Structs.html">Structures</a>
            <ul class="nav-group-tasks">
              <li class="nav-group-task">
                <a href="Structs/AggregateOptions.html">AggregateOptions</a>
              </li>
              <li class="nav-group-task">
                <a href="Structs/AnyBSONValue.html">AnyBSONValue</a>
              </li>
              <li class="nav-group-task">
                <a href="Structs/BSONCoderOptions.html">BSONCoderOptions</a>
              </li>
              <li class="nav-group-task">
                <a href="Structs/BSONNull.html">BSONNull</a>
              </li>
              <li class="nav-group-task">
                <a href="Structs/BSONUndefined.html">BSONUndefined</a>
              </li>
              <li class="nav-group-task">
                <a href="Structs/Binary.html">Binary</a>
              </li>
              <li class="nav-group-task">
                <a href="Structs/Binary/Subtype.html">– Subtype</a>
              </li>
              <li class="nav-group-task">
                <a href="Structs/BulkWriteError.html">BulkWriteError</a>
              </li>
              <li class="nav-group-task">
                <a href="Structs/BulkWriteOptions.html">BulkWriteOptions</a>
              </li>
              <li class="nav-group-task">
                <a href="Structs/BulkWriteResult.html">BulkWriteResult</a>
              </li>
              <li class="nav-group-task">
                <a href="Structs/ClientOptions.html">ClientOptions</a>
              </li>
              <li class="nav-group-task">
                <a href="Structs/ClientSessionOptions.html">ClientSessionOptions</a>
              </li>
              <li class="nav-group-task">
                <a href="Structs/CodeWithScope.html">CodeWithScope</a>
              </li>
              <li class="nav-group-task">
                <a href="Structs/CollectionOptions.html">CollectionOptions</a>
              </li>
              <li class="nav-group-task">
                <a href="Structs/CommandFailedEvent.html">CommandFailedEvent</a>
              </li>
              <li class="nav-group-task">
                <a href="Structs/CommandStartedEvent.html">CommandStartedEvent</a>
              </li>
              <li class="nav-group-task">
                <a href="Structs/CommandSucceededEvent.html">CommandSucceededEvent</a>
              </li>
              <li class="nav-group-task">
                <a href="Structs/ConnectionId.html">ConnectionId</a>
              </li>
              <li class="nav-group-task">
                <a href="Structs/CountOptions.html">CountOptions</a>
              </li>
              <li class="nav-group-task">
                <a href="Structs/CreateCollectionOptions.html">CreateCollectionOptions</a>
              </li>
              <li class="nav-group-task">
                <a href="Structs/CreateIndexOptions.html">CreateIndexOptions</a>
              </li>
              <li class="nav-group-task">
                <a href="Structs/DBPointer.html">DBPointer</a>
              </li>
              <li class="nav-group-task">
                <a href="Structs/DatabaseOptions.html">DatabaseOptions</a>
              </li>
              <li class="nav-group-task">
                <a href="Structs/Decimal128.html">Decimal128</a>
              </li>
              <li class="nav-group-task">
                <a href="Structs/DeleteOptions.html">DeleteOptions</a>
              </li>
              <li class="nav-group-task">
                <a href="Structs/DeleteResult.html">DeleteResult</a>
              </li>
              <li class="nav-group-task">
                <a href="Structs/DistinctOptions.html">DistinctOptions</a>
              </li>
              <li class="nav-group-task">
                <a href="Structs/Document.html">Document</a>
              </li>
              <li class="nav-group-task">
                <a href="Structs/DropIndexOptions.html">DropIndexOptions</a>
              </li>
              <li class="nav-group-task">
                <a href="Structs/FindOneAndDeleteOptions.html">FindOneAndDeleteOptions</a>
              </li>
              <li class="nav-group-task">
                <a href="Structs/FindOneAndReplaceOptions.html">FindOneAndReplaceOptions</a>
              </li>
              <li class="nav-group-task">
                <a href="Structs/FindOneAndUpdateOptions.html">FindOneAndUpdateOptions</a>
              </li>
              <li class="nav-group-task">
                <a href="Structs/FindOptions.html">FindOptions</a>
              </li>
              <li class="nav-group-task">
                <a href="Structs/IndexModel.html">IndexModel</a>
              </li>
              <li class="nav-group-task">
                <a href="Structs/IndexOptions.html">IndexOptions</a>
              </li>
              <li class="nav-group-task">
                <a href="Structs/InsertManyResult.html">InsertManyResult</a>
              </li>
              <li class="nav-group-task">
                <a href="Structs/InsertOneOptions.html">InsertOneOptions</a>
              </li>
              <li class="nav-group-task">
                <a href="Structs/InsertOneResult.html">InsertOneResult</a>
              </li>
              <li class="nav-group-task">
                <a href="Structs/ListCollectionsOptions.html">ListCollectionsOptions</a>
              </li>
              <li class="nav-group-task">
                <a href="Structs/ListDatabasesOptions.html">ListDatabasesOptions</a>
              </li>
              <li class="nav-group-task">
                <a href="Structs/MaxKey.html">MaxKey</a>
              </li>
              <li class="nav-group-task">
                <a href="Structs/MinKey.html">MinKey</a>
              </li>
              <li class="nav-group-task">
                <a href="Structs/ObjectId.html">ObjectId</a>
              </li>
              <li class="nav-group-task">
                <a href="Structs/RegularExpression.html">RegularExpression</a>
              </li>
              <li class="nav-group-task">
                <a href="Structs/ReplaceOptions.html">ReplaceOptions</a>
              </li>
              <li class="nav-group-task">
                <a href="Structs/RunCommandOptions.html">RunCommandOptions</a>
              </li>
              <li class="nav-group-task">
                <a href="Structs/ServerClosedEvent.html">ServerClosedEvent</a>
              </li>
              <li class="nav-group-task">
                <a href="Structs/ServerDescription.html">ServerDescription</a>
              </li>
              <li class="nav-group-task">
                <a href="Structs/ServerDescription/ServerType.html">– ServerType</a>
              </li>
              <li class="nav-group-task">
                <a href="Structs/ServerDescriptionChangedEvent.html">ServerDescriptionChangedEvent</a>
              </li>
              <li class="nav-group-task">
                <a href="Structs/ServerHeartbeatFailedEvent.html">ServerHeartbeatFailedEvent</a>
              </li>
              <li class="nav-group-task">
                <a href="Structs/ServerHeartbeatStartedEvent.html">ServerHeartbeatStartedEvent</a>
              </li>
              <li class="nav-group-task">
                <a href="Structs/ServerHeartbeatSucceededEvent.html">ServerHeartbeatSucceededEvent</a>
              </li>
              <li class="nav-group-task">
                <a href="Structs/ServerOpeningEvent.html">ServerOpeningEvent</a>
              </li>
              <li class="nav-group-task">
                <a href="Structs/Symbol.html">Symbol</a>
              </li>
              <li class="nav-group-task">
                <a href="Structs/Timestamp.html">Timestamp</a>
              </li>
              <li class="nav-group-task">
                <a href="Structs/TopologyClosedEvent.html">TopologyClosedEvent</a>
              </li>
              <li class="nav-group-task">
                <a href="Structs/TopologyDescription.html">TopologyDescription</a>
              </li>
              <li class="nav-group-task">
                <a href="Structs/TopologyDescription/TopologyType.html">– TopologyType</a>
              </li>
              <li class="nav-group-task">
                <a href="Structs/TopologyDescriptionChangedEvent.html">TopologyDescriptionChangedEvent</a>
              </li>
              <li class="nav-group-task">
                <a href="Structs/TopologyOpeningEvent.html">TopologyOpeningEvent</a>
              </li>
              <li class="nav-group-task">
                <a href="Structs/UpdateOptions.html">UpdateOptions</a>
              </li>
              <li class="nav-group-task">
                <a href="Structs/UpdateResult.html">UpdateResult</a>
              </li>
              <li class="nav-group-task">
                <a href="Structs/WriteConcernError.html">WriteConcernError</a>
              </li>
              <li class="nav-group-task">
                <a href="Structs/WriteError.html">WriteError</a>
              </li>
            </ul>
          </li>
          <li class="nav-group-name">
            <a href="Typealiases.html">Type Aliases</a>
            <ul class="nav-group-tasks">
              <li class="nav-group-task">
                <a href="Typealiases.html#/s:10MongoSwift17InsertManyOptionsa">InsertManyOptions</a>
              </li>
              <li class="nav-group-task">
                <a href="Typealiases.html#/s:10MongoSwift15ServerErrorCodea">ServerErrorCode</a>
              </li>
            </ul>
          </li>
        </ul>
      </nav>
      <article class="main-content">
        <section>
          <section class="section">
            
            <h1 id='swift-driver-error-handling-guide' class='heading'>Swift Driver Error Handling Guide</h1>
<h2 id='index' class='heading'>Index</h2>

<ul>
<li><a href="#error-types">Error Types</a>

<ul>
<li><a href="#server-errors">Server Errors</a></li>
<li><a href="#user-errors">User Errors</a></li>
<li><a href="#runtime-errors">Runtime Errors</a></li>
<li><a href="#encoding-decoding-errors">Encoding/Decoding Errors</a></li>
</ul></li>
<li><a href="#the-code">Examples</a>

<ul>
<li><a href="#handling-any-error-thrown-by-the-driver">All Errors</a></li>
<li><a href="#handling-a-commanderror">CommandError</a></li>
<li><a href="#handling-a-writeerror">WriteError</a></li>
<li><a href="#handling-a-bulkwriteerror">BulkWriteError</a></li>
</ul></li>
<li><a href="#see-also">See Also</a></li>
</ul>
<h2 id='error-types' class='heading'>Error Types</h2>

<p>The driver uses errors to communicate that an operation failed, an assumption wasn&rsquo;t met, or that the user did something incorrectly. Applications that use the driver can in turn catch these errors and respond appropriately without crashing or resulting in an otherwise inconsistent state. To correctly model the different sources of errors, the driver defines three separate types of errors (<code><a href="Enums/ServerError.html">ServerError</a></code>, <code><a href="Enums/UserError.html">UserError</a></code>, <code><a href="Enums/RuntimeError.html">RuntimeError</a></code>), each of which conforms to the <code><a href="Protocols.html#/s:10MongoSwift0A5ErrorP">MongoError</a></code> protocol. These errors are defined in <code>MongoError.swift</code> and are outlined here. The documentation for every public function that throws lists some of the errors that could possibly be thrown and the reasons they might be. The errors listed there are not comprehensive but will generally cover the most common cases.</p>

<p><strong>Error Labels:</strong> Some types of errors may contain more specific information describing the context in which they occured. This information is conveyed through the usage of <code>errorLabels</code>. Specifically, any server error or connection related error may contain labels.</p>
<h3 id='server-errors' class='heading'>Server Errors</h3>

<p>Server errors correspond to failures that occur in the database itself and are returned to the driver via some response to a command. Each <code><a href="Enums/ServerError.html">ServerError</a></code> case contains at least one error code representing what went wrong on the server.</p>

<p>For an enumeration of the possible server error codes, <a href="https://github.com/mongodb/mongo/blob/master/src/mongo/base/error_codes.err">see this list</a>.</p>

<p>The <code><a href="Enums/ServerError.html">ServerError</a></code> cases are as follows:</p>

<ul>
<li><code>.commandError(code: ServerErrorCode, message: String, errorLabels: [String]?)</code>:

<ul>
<li>Thrown when commands experience errors server side that prevent execution.</li>
<li>Example command failures include failure to parse, operation aborted by the user, and unexpected errors during execution.</li>
</ul></li>
<li><code>.writeError(writeError: WriteError?, writeConcernError: WriteConcernError?, errorLabels: [String]?)</code>

<ul>
<li>Thrown when a single write command fails on the server.</li>
<li>Only one of the two optionals will be non-nil.</li>
</ul></li>
<li><code>.bulkWriteError(writeErrors: [BulkWriteError]?, writeConcernError: WriteConcernError?, result: BulkWriteResult, errorLabels: [String]?)</code>

<ul>
<li>Thrown when the server returns errors as part of an executed bulk write.</li>
<li>If WriteConcernError is populated, writeErrors may not be.</li>
<li><strong>Note:</strong> <code>InsertMany</code> throws a <code>.bulkWriteError</code>, <em>not</em> a <code>.writeError</code>.</li>
</ul></li>
</ul>
<h3 id='user-errors' class='heading'>User Errors</h3>

<p>User applications can sometimes cause errors by using the driver incorrectly (e.g. by passing invalid argument combinations). This category of error covers those cases.</p>

<p>The <code><a href="Enums/UserError.html">UserError</a></code> cases are as follows:</p>

<ul>
<li><code>.logicError(message: String)</code>

<ul>
<li>Thrown when the user uses the driver incorrectly (e.g. advancing a dead cursor).</li>
</ul></li>
<li><code>.invalidArgument(message: String)</code>

<ul>
<li>Thrown when user passes invalid arguments to some driver function.</li>
</ul></li>
</ul>
<h3 id='runtime-errors' class='heading'>Runtime Errors</h3>

<p>The driver may experience errors that happen at runtime unexpectedly. These errors don&rsquo;t fit neatly into the categories of occurring only server-side or only as part of the user&rsquo;s fault, so they are represented by their own set of cases.</p>

<p>The <code><a href="Enums/RuntimeError.html">RuntimeError</a></code> cases are as follows:</p>

<ul>
<li><code>.internalError(message: String)</code>

<ul>
<li>Thrown when something is null when it shouldn&rsquo;t be, the driver has an internal failure, or MongoSwift cannot understand a server response.</li>
<li>This is generally indicative of a bug somewhere in the driver stack or a system related failure (e.g. memory allocation failure). If you experience an error that you think is the result of a bug, please file a bug report on GitHub or our Jira project.</li>
</ul></li>
<li><code>.connectionError(message: String, errorLabels: [String]?)</code>

<ul>
<li>Thrown during any connection establishment / socket related errors.</li>
</ul></li>
<li><code>.authenticationError(message: String)</code>

<ul>
<li>Thrown when the driver is not authorized to perform a requested command (e.g. due to invalid credentials)</li>
</ul></li>
</ul>
<h3 id='encoding-decoding-errors' class='heading'>Encoding/Decoding Errors</h3>

<p>As part of the driver, <code><a href="Classes/BSONEncoder.html">BSONEncoder</a></code> and <code><a href="Classes/BSONDecoder.html">BSONDecoder</a></code> are implemented according to the <code>Encoder</code> and <code>Decoder</code> protocols <a href="https://developer.apple.com/documentation/foundation/archives_and_serialization/encoding_and_decoding_custom_types">defined in Apple&rsquo;s Foundation</a>. User applications can use them to seamlessly convert between their Swift data structures and the BSON documents stored in the database. While this functionality is part of the public API, the driver itself also makes heavy use of it internally. During any encoding or decoding operations, errors can occur that prevent the data from being written to or read from BSON. In these cases, the driver throws an <code>EncodingError</code> or <code>DecodingError</code> as appropriate. These error types are not unique to MongoSwift and are commonly used by other encoder implementations, such as Foundation&rsquo;s <code>JSONEncoder</code>, so they do not conform to the <code><a href="Protocols.html#/s:10MongoSwift0A5ErrorP">MongoError</a></code> protocol.</p>

<p>See the official documentation for both <a href="https://developer.apple.com/documentation/swift/encodingerror"><code>EncodingErrors</code></a> and <a href="https://developer.apple.com/documentation/swift/decodingerror"><code>DecodingErrors</code></a> for more information.</p>
<h2 id='examples' class='heading'>Examples</h2>
<h3 id='handling-any-error-thrown-by-the-driver' class='heading'>Handling any error thrown by the driver</h3>
<pre class="highlight swift"><code><span class="k">do</span> <span class="p">{</span>
    <span class="c1">// something involving the driver</span>
<span class="p">}</span> <span class="k">catch</span> <span class="k">let</span> <span class="nv">error</span> <span class="k">as</span> <span class="kt">MongoError</span> <span class="p">{</span>
    <span class="nf">print</span><span class="p">(</span><span class="s">"Driver error!"</span><span class="p">)</span>
    <span class="k">switch</span> <span class="n">error</span><span class="o">.</span><span class="k">self</span> <span class="p">{</span>
    <span class="k">case</span> <span class="k">let</span> <span class="nv">runtimeError</span> <span class="k">as</span> <span class="kt">RuntimeError</span><span class="p">:</span>
        <span class="c1">// handle RuntimeError</span>
    <span class="k">case</span> <span class="k">let</span> <span class="nv">serverError</span> <span class="k">as</span> <span class="kt">ServerError</span><span class="p">:</span>
        <span class="c1">// handle ServerError</span>
    <span class="k">case</span> <span class="k">let</span> <span class="nv">userError</span> <span class="k">as</span> <span class="kt">UserError</span><span class="p">:</span>
        <span class="c1">// handle UserError</span>
    <span class="k">default</span><span class="p">:</span>
        <span class="c1">// should never get here</span>
    <span class="p">}</span>
<span class="p">}</span> <span class="k">catch</span> <span class="k">let</span> <span class="nv">error</span> <span class="k">as</span> <span class="kt">DecodingError</span> <span class="p">{</span>
    <span class="c1">// handle DecodingError</span>
<span class="p">}</span> <span class="k">catch</span> <span class="k">let</span> <span class="nv">error</span> <span class="k">as</span> <span class="kt">EncodingError</span> <span class="p">{</span>
    <span class="c1">// handle EncodingError</span>
<span class="p">}</span> <span class="k">catch</span> <span class="p">{</span> <span class="o">...</span> <span class="p">}</span>
</code></pre>
<h3 id='handling-a-commanderror' class='heading'>Handling a CommandError</h3>
<pre class="highlight swift"><code><span class="k">do</span> <span class="p">{</span>
    <span class="k">try</span> <span class="n">db</span><span class="o">.</span><span class="nf">runCommand</span><span class="p">([</span><span class="s">"asdfasdf"</span><span class="p">:</span> <span class="s">"sadfsadfasdf"</span><span class="p">])</span>
<span class="p">}</span> <span class="k">catch</span> <span class="k">let</span> <span class="nv">ServerError</span><span class="o">.</span><span class="nf">commandError</span><span class="p">(</span><span class="n">code</span><span class="p">,</span> <span class="n">message</span><span class="p">,</span> <span class="n">_</span><span class="p">)</span> <span class="p">{</span>
    <span class="nf">print</span><span class="p">(</span><span class="s">"Command failed: code: </span><span class="se">\(</span><span class="n">code</span><span class="se">)</span><span class="s"> message: </span><span class="se">\(</span><span class="n">message</span><span class="se">)</span><span class="s">"</span><span class="p">)</span>
<span class="p">}</span> <span class="k">catch</span> <span class="p">{</span> <span class="o">...</span> <span class="p">}</span>
</code></pre>

<p>Output:</p>
<pre class="highlight plaintext"><code>Command failed: code: 59 message: no such command: 'asdfasdf'
</code></pre>
<h3 id='handling-a-writeerror' class='heading'>Handling a WriteError</h3>
<pre class="highlight swift"><code><span class="c1">// if you want to ignore duplicate key errors</span>
<span class="k">do</span> <span class="p">{</span>
    <span class="k">try</span> <span class="n">coll</span><span class="o">.</span><span class="nf">insertOne</span><span class="p">([</span><span class="s">"_id"</span><span class="p">:</span> <span class="mi">1</span><span class="p">])</span>
    <span class="k">try</span> <span class="n">coll</span><span class="o">.</span><span class="nf">insertOne</span><span class="p">([</span><span class="s">"_id"</span><span class="p">:</span> <span class="mi">1</span><span class="p">])</span>
<span class="p">}</span> <span class="k">catch</span> <span class="k">let</span> <span class="nv">ServerError</span><span class="o">.</span><span class="nf">writeError</span><span class="p">(</span><span class="n">writeError</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span><span class="p">)</span> <span class="k">where</span> <span class="n">writeError</span><span class="p">?</span><span class="o">.</span><span class="n">code</span> <span class="o">==</span> <span class="mi">11000</span> <span class="p">{</span>
    <span class="nf">print</span><span class="p">(</span><span class="s">"duplicate key error: </span><span class="se">\(</span><span class="mi">1</span><span class="se">)</span><span class="s"> </span><span class="se">\(</span><span class="n">writeError</span><span class="p">?</span><span class="o">.</span><span class="n">message</span> <span class="p">??</span> <span class="s">""</span><span class="se">)</span><span class="s">"</span><span class="p">)</span>
<span class="p">}</span>
</code></pre>

<p>Output:</p>
<pre class="highlight plaintext"><code>duplicate key error: 1 E11000 duplicate key error collection: mydb.mycoll1 index: _id_ dup key: { : 1 }
</code></pre>
<h3 id='handling-a-bulkwriteerror' class='heading'>Handling a BulkWriteError</h3>
<pre class="highlight swift"><code><span class="k">let</span> <span class="nv">docs</span><span class="p">:</span> <span class="p">[</span><span class="kt">Document</span><span class="p">]</span> <span class="o">=</span> <span class="p">[[</span><span class="s">"_id"</span><span class="p">:</span> <span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="s">"_id"</span><span class="p">:</span> <span class="mi">1</span><span class="p">]]</span>
<span class="k">do</span> <span class="p">{</span>
    <span class="k">try</span> <span class="n">coll</span><span class="o">.</span><span class="nf">insertOne</span><span class="p">([</span><span class="s">"_id"</span><span class="p">:</span> <span class="mi">1</span><span class="p">])</span>
    <span class="k">try</span> <span class="n">coll</span><span class="o">.</span><span class="nf">insertMany</span><span class="p">(</span><span class="n">docs</span><span class="p">)</span>
<span class="p">}</span> <span class="k">catch</span> <span class="k">let</span> <span class="nv">ServerError</span><span class="o">.</span><span class="nf">bulkWriteError</span><span class="p">(</span><span class="n">writeErrors</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">result</span><span class="p">,</span> <span class="n">_</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">if</span> <span class="k">let</span> <span class="nv">writeErrors</span> <span class="o">=</span> <span class="n">writeErrors</span> <span class="p">{</span>
        <span class="n">writeErrors</span><span class="o">.</span><span class="n">forEach</span> <span class="p">{</span> <span class="n">err</span> <span class="k">in</span> <span class="nf">print</span><span class="p">(</span><span class="s">"Write Error inserting </span><span class="se">\(</span><span class="n">docs</span><span class="p">[</span><span class="n">err</span><span class="o">.</span><span class="n">index</span><span class="p">]</span><span class="se">)</span><span class="s">, code: </span><span class="se">\(</span><span class="n">err</span><span class="o">.</span><span class="n">code</span><span class="se">)</span><span class="s">, message: </span><span class="se">\(</span><span class="n">err</span><span class="o">.</span><span class="n">message</span><span class="se">)</span><span class="s">"</span><span class="p">)</span> <span class="p">}</span>
    <span class="p">}</span>
    <span class="k">if</span> <span class="k">let</span> <span class="nv">result</span> <span class="o">=</span> <span class="n">result</span> <span class="p">{</span>
        <span class="nf">print</span><span class="p">(</span><span class="s">"Result: "</span><span class="p">)</span>
        <span class="nf">print</span><span class="p">(</span><span class="s">"nInserted: </span><span class="se">\(</span><span class="n">result</span><span class="o">.</span><span class="n">insertedCount</span><span class="se">)</span><span class="s">"</span><span class="p">)</span>
        <span class="nf">print</span><span class="p">(</span><span class="s">"InsertedIds: </span><span class="se">\(</span><span class="n">result</span><span class="o">.</span><span class="n">insertedIds</span><span class="se">)</span><span class="s">"</span><span class="p">)</span>
    <span class="p">}</span>
<span class="p">}</span> <span class="k">catch</span> <span class="p">{</span> <span class="o">...</span> <span class="p">}</span>
</code></pre>

<p>Output:</p>
<pre class="highlight plaintext"><code>Write Error inserting { "_id" : 1 }, code: 11000, message: E11000 duplicate key error collection: mydb.mycoll1 index: _id_ dup key: { : 1 }
Result:
nInserted: 1
InsertedIds: [0: 2]
</code></pre>
<h2 id='see-also' class='heading'>See Also</h2>

<ul>
<li><a href="https://docs.swift.org/swift-book/LanguageGuide/ErrorHandling.html">Error handling in Swift</a></li>
<li><a href="https://github.com/mongodb/mongo/blob/master/src/mongo/base/error_codes.err">List of server error codes</a></li>
<li><a href="https://github.com/mongodb/specifications/blob/master/source/crud/crud.rst#error-handling">CRUD Spec error definitions</a></li>
<li><a href="https://developer.apple.com/documentation/swift/encodingerror">EncodingError documentation</a></li>
<li><a href="https://developer.apple.com/documentation/swift/decodingerror">DecodingError documentation</a></li>
</ul>

          </section>
        </section>
        <section id="footer">
          <p>&copy; 2019 <a class="link" href="" target="_blank" rel="external">Matt Broadstone, Kaitlin Mahar, and Patrick Freed</a>. All rights reserved. (Last updated: 2019-06-04)</p>
          <p>Generated by <a class="link" href="https://github.com/realm/jazzy" target="_blank" rel="external">jazzy ♪♫ v0.9.6</a>, a <a class="link" href="https://realm.io" target="_blank" rel="external">Realm</a> project.</p>
        </section>
      </article>
    </div>
  </body>
</div>
</html>
